import{jsxs,Fragment,jsx}from"react/jsx-runtime";import{forwardRef,useState,useRef}from"react";import styled from"styled-components";import{keyboardKey}from"../common/keyboardKey.es.js";import{OpenStatusButton}from"../OpenStatusButton.es.js";import{StyledDropdownContainer}from"../DropdownContainer/index.es.js";import{Menu}from"../Menu/index.es.js";const StyledMenu=styled(Menu)`
  width: ${({$width})=>$width||"auto"};
`,DropMenuContainer=styled(StyledDropdownContainer)`
  ${p=>p.$dropContainerCssMixin||""}
`,DropMenu=forwardRef(({dimension="m",menuWidth,disabled=!1,loading=!1,alignSelf="flex-end",onClose,onOpen,items,selected,active,onSelectItem,onActivateItem,onChange,onClick,onKeyDown,alignMenuRef,targetElement,renderContentProp,menuMaxHeight,dropContainerCssMixin,dropContainerClassName,dropContainerStyle,multiSelection=!1,disableSelectedOptionHighlight=!1,isVisible,onVisibilityChange=()=>{},onClickOutside,renderTopPanel,renderBottomPanel,onForwardCycleApprove,onBackwardCycleApprove,virtualScroll,...props},ref)=>{const[isMenuOpenState,setIsMenuOpenState]=useState(!1),btnRef=useRef(null),targetNode=targetElement||alignMenuRef?.current||btnRef.current,isMenuOpen=isVisible??isMenuOpenState,setIsMenuOpen=newMenuOpenState=>{setIsMenuOpenState(newMenuOpenState),onVisibilityChange(newMenuOpenState)},closeMenu=()=>{setIsMenuOpen(!1),onClose?.(),btnRef.current?.focus()};return jsxs(Fragment,{children:[renderContentProp({disabled,buttonRef:btnRef,handleKeyDown:e=>{const code=keyboardKey.getCode(e);switch(onKeyDown?.(e),code){case keyboardKey.Escape:isMenuOpen&&closeMenu();break;case keyboardKey.Enter:case keyboardKey[" "]:isMenuOpen||(e.stopPropagation(),setIsMenuOpen(!0),onOpen?.(),e.preventDefault())}},handleClick:e=>{isMenuOpen?onClose?.():onOpen?.(),setIsMenuOpen(!isMenuOpen),onClick?.(e)},statusIcon:jsx(OpenStatusButton,{$isOpen:isMenuOpen,"aria-hidden":!0}),menuState:isMenuOpen}),isMenuOpen&&!loading&&jsx(DropMenuContainer,{ref,role:"listbox",alignSelf,targetElement:targetNode,onClickOutside:e=>{e.target&&btnRef.current?.contains(e.target)||(onClickOutside?onClickOutside(e):(setIsMenuOpen(!1),onClose?.()))},$dropContainerCssMixin:dropContainerCssMixin,className:dropContainerClassName,style:dropContainerStyle,...props,children:jsx(StyledMenu,{maxHeight:menuMaxHeight,$width:menuWidth,virtualScroll,model:items,selected,onSelectItem:id=>{onChange?.(id),onSelectItem?.(id),void 0!==isVisible||multiSelection||disableSelectedOptionHighlight||closeMenu()},dimension,active,onActivateItem,multiSelection,disableSelectedOptionHighlight,renderTopPanel,renderBottomPanel,onForwardCycleApprove,onBackwardCycleApprove})})]})});DropMenu.displayName="DropMenu";export{DropMenu};
//# sourceMappingURL=index.es.js.map
