import{jsx,jsxs,Fragment}from"react/jsx-runtime";import*as e from"react";import{MenuButton}from"./Menu.es.js";import{Breadcrumb}from"./BreadCrumb.es.js";import{Navigation,Wrapper,OverflowContentWrapper,OverflowContent,Compensator,OverflowItem,Separator}from"./style.es.js";const Breadcrumbs=({items,dimension="l",mobile,lastBreadcrumbActive=!1,dropContainerCssMixin,dropContainerClassName,dropContainerStyle,...props})=>{const iconSize="l"===dimension?20:16,visible=items.slice(1,items.length-1),wrapperRef=e.useRef(null),overflowRef=e.useRef(null),hasMounted=e.useRef(!1),[visibilityMap,setVisibilityMap]=e.useState({0:!0,[items.length-1]:!0}),[opacity,setOpacity]=e.useState(mobile?1:0);e.useEffect(()=>{hasMounted.current||(hasMounted.current=!0)},[]),e.useLayoutEffect(()=>{const firstCrumb=wrapperRef.current?.firstElementChild;if(firstCrumb&&mobile){const resizeObserver=new ResizeObserver(()=>{wrapperRef.current?.scrollBy({left:wrapperRef.current.scrollWidth,behavior:"smooth"})});return resizeObserver.observe(firstCrumb),()=>{resizeObserver.disconnect()}}},[mobile]),e.useLayoutEffect(()=>{mobile&&wrapperRef.current&&(hasMounted.current?wrapperRef.current.scrollBy({left:wrapperRef.current.scrollWidth,behavior:"smooth"}):wrapperRef.current?.scrollBy({left:wrapperRef.current.scrollWidth}))},[items,mobile]);const handleIntersection=entries=>{const updatedEntries={};entries.forEach(entry=>{const targetNumber=entry.target.dataset.number;targetNumber&&(updatedEntries[targetNumber]=entry.isIntersecting&&entry.intersectionRatio>.99)}),setVisibilityMap(prev=>({...prev,...updatedEntries})),setOpacity(1)};e.useLayoutEffect(()=>{const observer=new IntersectionObserver(handleIntersection,{root:wrapperRef.current,threshold:[0,1]});return overflowRef.current&&!mobile&&Array.from(overflowRef.current.children).forEach(item=>{observer.observe(item)}),()=>observer.disconnect()},[mobile,setVisibilityMap,setOpacity,items]);const renderFirstItem=e.useCallback(()=>{const item=items[0],id=item?.id||item?.text;return items.length>1?jsx(Breadcrumb,{"data-number":0,dimension,...item},id):null},[items,dimension]),renderLastItem=e.useCallback(()=>{const item=items[items.length-1],id=item?.id||item?.text;return items.length>0?jsx(Breadcrumb,{"aria-current":"page","data-number":items.length-1,dimension,active:lastBreadcrumbActive,displaySeparator:!1,...mobile?{}:{style:{order:1}},...item},id):null},[items,mobile,dimension,lastBreadcrumbActive]),renderVisibleItems=()=>visible.map((item,index)=>{const id=item.id||item.text,order={style:{order:items.length-index-1}};return jsx(Breadcrumb,{"data-number":index+1,tabIndex:visibilityMap[index+1]?0:-1,dimension,...mobile?{}:order,...item},id)});return jsx(Navigation,{"aria-label":"Breadcrumb",...props,children:jsx(Wrapper,{ref:wrapperRef,$mobile:mobile,$opacity:opacity,role:"list",children:jsxs(Fragment,mobile?{children:[renderFirstItem(),renderVisibleItems(),renderLastItem()]}:{children:[renderFirstItem(),(()=>{const hiddenItems=items.filter((_,index)=>!visibilityMap[index]);return hiddenItems.length?jsxs(OverflowItem,{children:[jsx(MenuButton,{options:hiddenItems,dimension:"l"===dimension?"m":"s",dropContainerCssMixin,dropContainerClassName,dropContainerStyle,"aria-label":""}),jsx(Separator,{width:iconSize,height:iconSize,"aria-hidden":!0})]}):null})(),jsx(OverflowContentWrapper,{$dimension:dimension,"data-overflow":!0,children:jsxs(OverflowContent,{ref:overflowRef,children:[renderVisibleItems(),renderLastItem(),jsx(Compensator,{"aria-hidden":!0})]})})]})})})};Breadcrumbs.displayName="Breadcrumbs";export{Breadcrumbs};
//# sourceMappingURL=index.es.js.map
