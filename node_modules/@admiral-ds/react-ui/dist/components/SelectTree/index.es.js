import{jsx}from"react/jsx-runtime";import*as e from"react";import styled from"styled-components";import{SelectTreeNode}from"./SelectTreeNode.es.js";import{keyboardKey}from"../common/keyboardKey.es.js";import{setNodeStatus,updateNodeStatus,checkParent}from"./utils.es.js";const TreeItem=styled.ul`
  list-style: none;
  margin: 0;
  padding: 0;
`,SelectTree=({list,dimension="m",expandAll=!1,onChange,...props})=>{const[handleGuard,setHandleGuard]=e.useState(!1),handleExpandAll=node=>{void 0===node.expanded&&node.children&&(node.expanded=expandAll,node.children&&node.children.forEach(handleExpandAll))},handleChangeList=(type,e)=>{const checked=e.target.checked,key=e.target.getAttribute("data-key"),traverseNodes=node=>{if(node.id===key){if("buttonclick"===type){const expanded=node.expanded;node.expanded=!expanded}if("inputchange"===type&&(node.status=checked?"checked":"unchecked",checked&&checkParent(list,node),node.children&&node.children.forEach(checkAllNodes)),"keydown"===type){const code=keyboardKey.getCode(e);code===keyboardKey.Enter||code===keyboardKey[" "]?node.expanded=!0:code===keyboardKey.Escape&&(node.expanded=!1)}}node.children&&node.children.forEach(traverseNodes)},checkAllNodes=node=>{"status"in node&&(node.status=checked?"checked":"unchecked",node.checked=checked),node.children&&node.children.forEach(checkAllNodes)};list.forEach(traverseNodes),onChange?.([...list])},handleButtonClick=e.useCallback(e=>{handleChangeList("buttonclick",e)},[]),handleChange=e.useCallback(e=>{handleChangeList("inputchange",e)},[]),handleKeyDown=e.useCallback(e=>{handleChangeList("keydown",e)},[]);return e.useEffect(()=>{expandAll&&(list.forEach(handleExpandAll),onChange?.([...list]))},[expandAll]),handleGuard||(setNodeStatus(list),setHandleGuard(!0)),updateNodeStatus(list),jsx(TreeItem,{...props,children:list.map(node=>jsx(SelectTreeNode,{node,onChange:handleChange,dimension,expandAll,onButtonClick:handleButtonClick,onKeyDown:handleKeyDown,level:0},node.id))})};SelectTree.displayName="SelectTree";export{SelectTree};
//# sourceMappingURL=index.es.js.map
