import{jsxs,Fragment,jsx}from"react/jsx-runtime";import{forwardRef,useState,useRef,useLayoutEffect}from"react";import{isInputDataDifferent,changeInputData}from"../../common/dom/changeInputData.es.js";import{typography}from"../../Typography/typography.es.js";import"../../Typography/defaultTypographyMixin.es.js";import styled,{css}from"styled-components";import{refSetter}from"../../common/utils/refSetter.es.js";function defaultHandleInput(newInputData){return newInputData||{}}const Prefix=styled.div`
  display: flex;
  flex-shrink: 0;
  align-items: center;
  user-select: none;
  color: ${({theme,disabled})=>disabled?`var(--admiral-color-Neutral_Neutral30, ${theme.color["Neutral/Neutral 30"]})`:`var(--admiral-color-Neutral_Neutral50, ${theme.color["Neutral/Neutral 50"]})`};
  ${({$align})=>"right"===$align&&"margin-left: auto;"}
`,Suffix=styled(Prefix)`
  min-width: 0;
  ${({$align})=>"right"===$align&&css`
      flex: 0 1 auto;
      margin-left: 0;
    `}
`,Sizer=styled.div`
  display: flex;
  flex-shrink: 0;
  visibility: hidden;
  white-space: pre;
  box-sizing: border-box;
  ${({$hasPrefix,$align})=>!$hasPrefix&&"right"===$align&&"margin-left: auto;"}
`,BorderedDiv=styled.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  margin: 0;
  pointer-events: none;
  overflow: hidden;
  min-width: 0;

  background: none;
  border: 1px solid
    ${({theme,$status})=>"error"===$status?`var(--admiral-color-Error_Error60Main, ${theme.color["Error/Error 60 Main"]})`:"success"===$status?`var(--admiral-color-Success_Success50Main, ${theme.color["Success/Success 50 Main"]})`:`var(--admiral-color-Neutral_Neutral40, ${theme.color["Neutral/Neutral 40"]})`};
  border-radius: inherit;

  [data-read-only] & {
    border-color: transparent;
  }
`,colorsBorderAndBackground=css`
  &:focus + ${BorderedDiv} {
    border: 2px solid var(--admiral-color-Primary_Primary60Main, ${p=>p.theme.color["Primary/Primary 60 Main"]});
  }

  &:disabled + ${BorderedDiv} {
    border-color: transparent;
  }

  &[data-status='error']:focus + ${BorderedDiv}, &:user-invalid:focus + ${BorderedDiv} {
    border: 2px solid var(--admiral-color-Error_Error60Main, ${p=>p.theme.color["Error/Error 60 Main"]});
  }

  &:user-invalid + ${BorderedDiv} {
    border: 1px solid var(--admiral-color-Error_Error60Main, ${p=>p.theme.color["Error/Error 60 Main"]});
  }

  &[data-status='success']:focus + ${BorderedDiv} {
    border: 2px solid var(--admiral-color-Success_Success50Main, ${p=>p.theme.color["Success/Success 50 Main"]});
  }

  &:disabled {
    color: var(--admiral-color-Neutral_Neutral30, ${p=>p.theme.color["Neutral/Neutral 30"]});
  }

  [data-read-only] &:focus + ${BorderedDiv} {
    border-color: transparent;
  }
`,ieFixes=css`
  ::-ms-clear,
  ::-ms-reveal {
    display: none;
  }
`,Input=styled.input`
  outline: none;
  appearance: none;
  border: none;
  padding: 0;
  position: relative;
  box-sizing: border-box;
  display: flex;
  flex: 1 0 auto;
  max-width: 100%;

  background: transparent;
  color: var(--admiral-color-Neutral_Neutral90, ${p=>p.theme.color["Neutral/Neutral 90"]});
  text-align: ${({$align})=>"left"===$align?"left":"right"};

  ${props=>"s"===props.$dimension?typography["Body/Body 2 Long"]:typography["Body/Body 1 Long"]}
  &::placeholder {
    color: var(--admiral-color-Neutral_Neutral50, ${p=>p.theme.color["Neutral/Neutral 50"]});
  }

  &:disabled::placeholder {
    color: var(--admiral-color-Neutral_Neutral30, ${p=>p.theme.color["Neutral/Neutral 30"]});
  }

  [data-disable-copying] & {
    user-select: none;
    pointer-events: none;
  }

  &:disabled {
    cursor: not-allowed;
  }

  ${colorsBorderAndBackground}
  ${ieFixes}
`,horizontalPaddingValue=props=>{switch(props.$dimension){case"xl":default:return 16;case"s":return 12}},iconSizeValue=props=>{switch(props.$dimension){case"xl":default:return 24;case"s":return 20}},HiddenContent=styled.div`
  position: absolute;
  top: 0;
  bottom: 0;
  overflow: hidden;
  pointer-events: none;
  box-sizing: border-box;
  display: flex;
  align-items: center;
  left: ${horizontalPaddingValue}px;
  right: ${props=>horizontalPaddingValue(props)+(iconSizeValue(props)+8)*(props.$iconCount??0)}px;
`,AutoSizeInput=forwardRef(({dimension,placeholder,type,prefix,suffix,status,iconCount,align,innerValue,hideSpaceAfterPrefix=!1,hideSpaceBeforeSuffix=!1,handleInput=defaultHandleInput,...props},ref)=>{const[showPrefixSuffix,setPrefixSuffix]=useState(!1),sizerRef=useRef(null),inputRef=useRef(null),prefixRef=useRef(null),suffixRef=useRef(null),updateInputLeftPadding=()=>{inputRef.current&&(showPrefixSuffix&&prefix?prefixRef.current&&showPrefixSuffix&&(inputRef.current.style.paddingLeft=`${prefixRef.current.getBoundingClientRect().width}px`):inputRef.current.style.paddingLeft="0px")},updateInputRightPadding=()=>{inputRef.current&&(showPrefixSuffix&&suffix&&"left"!==align?suffixRef.current&&showPrefixSuffix&&"right"===align&&(inputRef.current.style.paddingRight=`${suffixRef.current.getBoundingClientRect().width}px`):inputRef.current.style.paddingRight="0px")};return useLayoutEffect(()=>{const nullHandledValue=handleInput(null);function oninput(){const{value,selectionStart,selectionEnd}=this,inputData=handleInput({value,selectionStart,selectionEnd});placeholder&&!isInputDataDifferent(nullHandledValue,inputData)?changeInputData(this,{...inputData,value:""}):changeInputData(this,inputData)}if("date"!==type&&inputRef.current){const node=inputRef.current;node.addEventListener("input",oninput);const{value,selectionStart,selectionEnd}=node,inputData=handleInput({value,selectionStart,selectionEnd});return placeholder&&!isInputDataDifferent(nullHandledValue,inputData)?changeInputData(node,{...inputData,value:""}):changeInputData(node,inputData),()=>{node.removeEventListener("input",oninput)}}},[handleInput,inputRef.current,placeholder]),useLayoutEffect(()=>{var newValue;newValue=innerValue,sizerRef.current&&(sizerRef.current.innerHTML=newValue||placeholder||""),(newValue=>{setPrefixSuffix(!!newValue)})(innerValue)},[innerValue,placeholder,inputRef.current,sizerRef.current]),useLayoutEffect(()=>updateInputLeftPadding(),[prefix,dimension,prefixRef.current,inputRef.current,showPrefixSuffix]),useLayoutEffect(()=>updateInputRightPadding(),[suffix,dimension,suffixRef.current,inputRef.current,showPrefixSuffix,align]),useLayoutEffect(()=>{if(prefixRef.current){const resizeObserver=new ResizeObserver(entries=>{entries.forEach(()=>{updateInputLeftPadding()})});return resizeObserver.observe(prefixRef.current),()=>{resizeObserver.disconnect()}}},[prefixRef.current,inputRef.current,showPrefixSuffix,prefix]),useLayoutEffect(()=>{if(suffixRef.current){const resizeObserver=new ResizeObserver(entries=>{entries.forEach(()=>{updateInputRightPadding()})});return resizeObserver.observe(suffixRef.current),()=>{resizeObserver.disconnect()}}},[suffixRef.current,inputRef.current,showPrefixSuffix,suffix,align]),jsxs(Fragment,{children:[jsxs(HiddenContent,{$iconCount:iconCount,$dimension:dimension,children:[prefix&&showPrefixSuffix&&jsxs(Prefix,{ref:prefixRef,disabled:props.disabled,$align:align,children:[prefix,!hideSpaceAfterPrefix&&jsx(Fragment,{children:" "})]}),jsx(Sizer,{ref:sizerRef,$hasPrefix:!!prefix,$align:align}),suffix&&showPrefixSuffix&&jsxs(Suffix,{ref:suffixRef,disabled:props.disabled,$align:align,children:[!hideSpaceBeforeSuffix&&jsx(Fragment,{children:" "}),suffix]})]}),jsx(Input,{...props,$dimension:dimension,ref:refSetter(ref,inputRef),placeholder,type:"text","data-status":status,$align:align}),jsx(BorderedDiv,{$status:status})]})});export{AutoSizeInput,BorderedDiv,horizontalPaddingValue,iconSizeValue};
//# sourceMappingURL=AutoSizeInput.es.js.map
