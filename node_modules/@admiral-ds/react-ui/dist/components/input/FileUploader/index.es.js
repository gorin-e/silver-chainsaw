import{jsx,jsxs,Fragment}from"react/jsx-runtime";import*as e from"react";import{createElement}from"react";import{refSetter}from"../../common/utils/refSetter.es.js";import{FileInfo}from"./FileInfo.es.js";import{typography}from"../../Typography/typography.es.js";import"../../Typography/defaultTypographyMixin.es.js";import{ReactComponent as SvgAttachFileOutline}from"../../../node_modules/@admiral-ds/icons/build/system/AttachFileOutline.svg.es.js";import styled,{css}from"styled-components";import{acceptFile}from"./utils.es.js";import{mediumGroupBorderRadius}from"../../themes/borderRadius.es.js";const Icon=styled(SvgAttachFileOutline)`
  height: ${p=>"xl"===p.$dimension?"40px":"24px"};
  width: ${p=>"xl"===p.$dimension?"40px":"24px"};
  margin-right: ${p=>"m"===p.$dimension?"14px":""};
  margin-bottom: ${p=>"xl"===p.$dimension?"14px":""};

  > * {
    fill: var(--admiral-color-Primary_Primary60Main, ${p=>p.theme.color["Primary/Primary 60 Main"]});
  }
`,disabledStyles=css`
  border: 1px dashed var(--admiral-color-Neutral_Neutral30, ${p=>p.theme.color["Neutral/Neutral 30"]});
  color: var(--admiral-color-Neutral_Neutral30, ${p=>p.theme.color["Neutral/Neutral 30"]});

  & svg {
    > * {
      fill: var(--admiral-color-Neutral_Neutral30, ${p=>p.theme.color["Neutral/Neutral 30"]});
    }
  }

  cursor: not-allowed;
  & > * {
    pointer-events: none;
  }
`,hoverStyles=css`
  &:hover {
    cursor: pointer;
    background: var(--admiral-color-Opacity_Hover, ${p=>p.theme.color["Opacity/Hover"]});
  }
  &:active {
    background: var(--admiral-color-Opacity_Press, ${p=>p.theme.color["Opacity/Press"]});
  }
`,CustomWrapper=styled.div`
  position: relative;
`,UploaderWrapperXL=styled.div`
  position: relative;
  display: flex;
  box-sizing: border-box;
  align-items: center;
  flex-direction: column;
  padding: 24px 0;
  border: 1px dashed var(--admiral-color-Neutral_Neutral40, ${p=>p.theme.color["Neutral/Neutral 40"]});
  border-radius: var(--admiral-border-radius-Medium, ${p=>mediumGroupBorderRadius(p.theme.shape)});
  ${p=>p.disabled?disabledStyles:hoverStyles};
`,UploaderWrapperM=styled.div`
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: row;
  padding: 8px 0;
  border: 1px dashed var(--admiral-color-Neutral_Neutral40, ${p=>p.theme.color["Neutral/Neutral 40"]});
  border-radius: var(--admiral-border-radius-Medium, ${p=>mediumGroupBorderRadius(p.theme.shape)});
  ${p=>p.disabled?disabledStyles:hoverStyles};
`,TitleText=styled.div`
  text-align: ${p=>"xl"===p.$dimension?"center":"start"};
  margin: 0 ${p=>"xl"===p.$dimension?"24px":""};
  margin-bottom: ${p=>"m"===p.$dimension?"16px":"0px"};
  max-width: 100%;
  color: ${p=>p.disabled?`var(--admiral-color-Neutral_Neutral30, ${p.theme.color["Neutral/Neutral 30"]})`:`var(--admiral-color-Neutral_Neutral90, ${p.theme.color["Neutral/Neutral 90"]})`};
  ${typography["Body/Body 2 Long"]};
`,Desc=styled.div`
  color: ${p=>p.disabled?`var(--admiral-color-Neutral_Neutral30, ${p.theme.color["Neutral/Neutral 30"]})`:`var(--admiral-color-Neutral_Neutral90, ${p.theme.color["Neutral/Neutral 90"]})`};
  ${typography["Body/Body 1 Long"]};
`,FileInput=styled.input`
  display: block;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  opacity: 0;
  cursor: pointer;
  &:disabled {
    cursor: not-allowed;
  }

  &:focus {
    outline: none;
  }
`,Wrapper=styled.div`
  ${typography["Body/Body 2 Long"]};
`,FileWrapper=styled.div`
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
`,FileUploader=e.forwardRef(({multiple=!0,dimension="xl",fileDimension="xl",renderFileInfoList:r,disabled,title,description,children,uploadedFiles,style,className,onRemoveFile,...props},ref)=>{const wrapperRef=e.useRef(null),inputRef=e.useRef(null),[files,setFiles]=e.useState(uploadedFiles),previewProps={dimension,fileDimension};e.useEffect(()=>{void 0!==uploadedFiles&&setFiles(uploadedFiles)},[uploadedFiles]),e.useEffect(()=>{function onChangeEventHandler(){const filesToAdd=Array.from(this.files||[]).filter(file=>!props.accept||acceptFile(file,props.accept)).map(file=>({file})),dt=new DataTransfer;filesToAdd.forEach(({file})=>dt.items.add(file)),this.files=dt.files,setFiles(filesToAdd)}const input=inputRef.current;if(input)return input.addEventListener("change",onChangeEventHandler,!0),()=>input.removeEventListener("change",onChangeEventHandler,!0)},[inputRef.current,files,props.accept]);const handleRemoveFile=index=>{if(inputRef.current&&inputRef.current.files){const files=inputRef.current.files,dt=new DataTransfer;for(let i=0;i<files.length;i++){const file=files.item(i);index!==i&&file&&dt.items.add(file)}let event;inputRef.current.files=dt.files,"function"==typeof Event?event=new Event("change",{bubbles:!0}):(event=document.createEvent("Event"),event.initEvent("change",!0,!0)),inputRef.current.dispatchEvent(event)}onRemoveFile?.(index)},renderFileInfoList=r??(({files,onRemoveFile})=>files.map((file,index)=>createElement(FileInfo,{...previewProps,key:index,file,onCloseClick:()=>onRemoveFile(index)})));return jsx(Wrapper,{ref:wrapperRef,style,className,children:jsxs(Fragment,"xl"===dimension?{children:[e.Children.count(children)?jsxs(CustomWrapper,{children:[children,jsx(FileInput,{...props,ref:refSetter(ref,inputRef),type:"file",multiple,disabled})]}):jsxs(UploaderWrapperXL,{disabled,children:[jsx(Icon,{$dimension:dimension}),title&&jsx(TitleText,{$dimension:dimension,disabled,children:title}),jsx(FileInput,{...props,ref:refSetter(ref,inputRef),type:"file",multiple,disabled})]}),files&&jsx(FileWrapper,{children:renderFileInfoList({files,onRemoveFile:handleRemoveFile})})]}:{children:[e.Children.count(children)?jsxs(CustomWrapper,{children:[children,jsx(FileInput,{...props,ref:refSetter(ref,inputRef),type:"file",multiple,disabled})]}):jsxs(Fragment,{children:[title&&jsx(TitleText,{$dimension:dimension,disabled,children:title}),jsxs(UploaderWrapperM,{disabled,children:[jsx(Icon,{$dimension:dimension}),description&&jsx(Desc,{disabled,children:description}),jsx(FileInput,{...props,ref:refSetter(ref,inputRef),type:"file",multiple,disabled})]})]}),files&&jsx(FileWrapper,{children:renderFileInfoList({files,onRemoveFile:handleRemoveFile})})]})})});FileUploader.displayName="FileUploader";export{FileInfo,FileUploader};
//# sourceMappingURL=index.es.js.map
