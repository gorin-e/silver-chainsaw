import{jsxs,jsx}from"react/jsx-runtime";import{useRef,useState,useEffect}from"react";import styled,{useTheme}from"styled-components";import{LIGHT_THEME}from"../../themes/light/index.es.js";import"../../themes/common/locales.es.js";import"../../Typography/typography.es.js";import"../../Typography/defaultTypographyMixin.es.js";import{NumberInput}from"../NumberInput/index.es.js";import{Range}from"../../Range/index.es.js";import{getDecimalSeparator,validateThousand,getThousandSeparator,clearValue,fitToCurrency}from"../NumberInput/utils.es.js";import{skeletonMixin}from"../Container.es.js";import{changeInputData}from"../../common/dom/changeInputData.es.js";const Wrapper=styled.div`
  position: relative;

  pointer-events: ${p=>p.skeleton?"none":"all"};
  ${({skeleton})=>skeleton&&skeletonMixin};
`,InputsWrapper=styled.div`
  display: flex;
  margin-bottom: 16px;
  [data-dimension='s'] & {
    margin-bottom: 12px;
  }
  & > div:first-child {
    margin-right: 8px;
  }
  & > div {
    width: 100%;
  }
`,SliderRange=({dimension,minValue=0,maxValue=20,step=1,precision=0,thousand:userThousand,decimal:userDecimal,prefix,suffix,placeholder,value,defaultValue,onChange,input1:input1Props,input2:input2Props,disabled,skeleton=!1,readOnly,...props})=>{const rangeDimension="s"===dimension?dimension:"m",theme=useTheme()||LIGHT_THEME,decimal=userDecimal?.slice(0,1)??getDecimalSeparator(theme.currentLocale),thousand=void 0!==userThousand&&validateThousand(userThousand)?userThousand.slice(0,1):getThousandSeparator(theme.currentLocale),input1Ref=useRef(null),input2Ref=useRef(null),[slider1,setSlider1]=useState(minValue),[slider2,setSlider2]=useState(maxValue),[innerInput1State,setInnerInput1State]=useState(defaultValue?.[0]||""),[innerInput2State,setInnerInput2State]=useState(defaultValue?.[1]||""),input1=value?.[0]||innerInput1State,input2=value?.[1]||innerInput2State,getFull=str=>fitToCurrency(String(str),precision,decimal,thousand,!0);useEffect(()=>{if(""===input1)setSlider1(minValue);else{const newSlider1=Number(clearValue(input1,precision,decimal).replace(decimal,"."));setSlider1(newSlider1)}},[input1,minValue,precision,decimal]),useEffect(()=>{if(""===input2)setSlider2(maxValue);else{const newSlider2=Number(clearValue(input2,precision,decimal).replace(decimal,"."));setSlider2(newSlider2)}},[input2,maxValue,precision,decimal]);const inputProps={dimension,precision,thousand,decimal,suffix,disabled,readOnly,displayPlusMinusIcons:!1,step};return jsxs(Wrapper,{"data-dimension":dimension,...props,children:[jsxs(InputsWrapper,{children:[jsx(NumberInput,{ref:input1Ref,value:input1,prefix:prefix?.[0],placeholder:placeholder?.[0],skeleton,onChange:event=>{const newSlider1=Number(clearValue(event.target.value,precision,decimal).replace(decimal,".")||minValue);setInnerInput1State(event.target.value),onChange?.([{str:event.target.value,num:newSlider1},{str:input2,num:slider2}],event)},onBlur:()=>{const value1Num=Number(clearValue(input1,precision,decimal).replace(decimal,".")||minValue),value2Num=Number(clearValue(input2,precision,decimal).replace(decimal,".")||maxValue);value1Num<minValue?input1Ref.current&&changeInputData(input1Ref.current,{value:getFull(minValue)}):value1Num>value2Num-step&&input1Ref.current&&changeInputData(input1Ref.current,{value:getFull(value2Num-step)})},...input1Props,...inputProps}),jsx(NumberInput,{ref:input2Ref,value:input2,prefix:prefix?.[1],placeholder:placeholder?.[1],skeleton,onChange:event=>{const newSlider2=Number(clearValue(event.target.value,precision,decimal).replace(decimal,".")||maxValue);setInnerInput2State(event.target.value),onChange?.([{str:input1,num:slider1},{str:event.target.value,num:newSlider2}],event)},onBlur:()=>{const value1Num=Number(clearValue(input1,precision,decimal).replace(decimal,".")||minValue),value2Num=Number(clearValue(input2,precision,decimal).replace(decimal,".")||maxValue);value2Num>maxValue?input2Ref.current&&changeInputData(input2Ref.current,{value:getFull(maxValue)}):value2Num<value1Num+step&&input2Ref.current&&changeInputData(input2Ref.current,{value:getFull(value1Num+step)})},...input2Props,...inputProps})]}),jsx(Range,{value:[slider1,slider2],skeleton,onChange:(_event,value)=>{const[newSld1,newSld2]=value,newSlider1=newSld1<minValue?minValue:newSld1,newSlider2=newSld2>maxValue?maxValue:newSld2;input1Ref.current&&changeInputData(input1Ref.current,{value:getFull(newSlider1)}),input2Ref.current&&changeInputData(input2Ref.current,{value:getFull(newSlider2)})},onMouseDown:e=>{e.preventDefault()},onRangeMouseUp:()=>{slider1==slider2&&slider1+step<=maxValue?input2Ref.current&&changeInputData(input2Ref.current,{value:getFull(slider2+step)}):slider1==slider2&&slider1+step>maxValue&&input1Ref.current&&changeInputData(input1Ref.current,{value:getFull(slider1-step)})},minValue,maxValue,step,dimension:rangeDimension,disabled:disabled||readOnly})]})};SliderRange.displayName="SliderRange";export{SliderRange};
//# sourceMappingURL=index.es.js.map
