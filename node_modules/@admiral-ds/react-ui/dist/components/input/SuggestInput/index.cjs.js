"use strict";var jsxRuntime=require("react/jsx-runtime"),e=require("react"),styled=require("styled-components"),SearchOutline=require("../../../node_modules/@admiral-ds/icons/build/system/SearchOutline.svg.cjs.js"),index$1=require("../../themes/light/index.cjs.js");require("../../themes/common/locales.cjs.js"),require("../../Typography/typography.cjs.js"),require("../../Typography/defaultTypographyMixin.cjs.js");var keyboardKey=require("../../common/keyboardKey.cjs.js"),changeInputData=require("../../common/dom/changeInputData.cjs.js"),refSetter=require("../../common/utils/refSetter.cjs.js"),InputIconButton=require("../../InputIconButton.cjs.js"),index=require("../../DropdownContainer/index.cjs.js"),index$3=require("../../Menu/index.cjs.js"),index$2=require("../TextInput/index.cjs.js"),MessagePanel=require("./MessagePanel.cjs.js"),SuggestPanel=require("./SuggestPanel.cjs.js");function _interopDefault(e){return e&&e.__esModule?e:{default:e}}const SuggestDropdownContainer=_interopDefault(styled).default(index.StyledDropdownContainer)`
  overflow-x: hidden;
  overflow-y: auto;
  min-width: 100%;
  padding: 8px 0;
  background-color: var(--admiral-color-Special_ElevatedBG, ${p=>p.theme.color["Special/Elevated BG"]});
`,SuggestInput=e.forwardRef(({options,isLoading,onOptionSelect,alignDropdown,dropMaxHeight,alignSelf="stretch",menuMaxHeight,dropContainerCssMixin,dropContainerClassName,dropContainerStyle,onSearchButtonClick=()=>{},icons,iconsAfter,icon=SearchOutline.ReactComponent,skeleton=!1,status,highlightFormat,locale,dimension="m",portalTargetRef,targetElement,...props},ref)=>{const theme=styled.useTheme()||index$1.LIGHT_THEME,isControlledComponentValue=void 0!==props.value,inputRef=e.useRef(null),targetNode=targetElement||portalTargetRef?.current||inputRef.current,[isSuggestPanelOpen,setIsSuggestPanelOpen]=e.useState(!1),[isFocused,setIsFocused]=e.useState(!1),[activeOption,setActiveOption]=e.useState(""),[searchText,setSearchText]=e.useState(props.value||""),currentSearchText=props.value??searchText,[,forceUpdate]=e.useReducer(x=>x+1,0),menuDimension="xl"===dimension?"l":dimension;e.useEffect(()=>{options&&setIsSuggestPanelOpen(isFocused)},[isFocused,options]);const[blurTrigger,triggerDelayedBlur]=e.useState();e.useEffect(()=>{if(blurTrigger){const timeoutID=setTimeout(()=>setIsFocused(!1),200);return()=>clearTimeout(timeoutID)}},[blurTrigger,setIsFocused]),e.useEffect(()=>{function onInputChange(){props.onInput||props.onChange||forceUpdate()}if(inputRef.current){const node=inputRef.current;return node.addEventListener("input",onInputChange),()=>{node.removeEventListener("input",onInputChange)}}},[props.onInput,props.onChange]);const iconArray=e.Children.toArray(iconsAfter||icons);props.readOnly||iconArray.push(jsxRuntime.jsx(InputIconButton.InputIconButton,{icon,onClick:onSearchButtonClick,"aria-hidden":!0}));const emptyAtLoading=0===(options||[]).length&&!!isLoading,model=e.useMemo(()=>options?options.map((text,index)=>({id:text,render:options=>jsxRuntime.jsx(SuggestPanel.SuggestPanel,{text,searchText:currentSearchText,highlightFormat,dimension:menuDimension,...options},index)})):[],[options,dimension,currentSearchText]);return e.useEffect(()=>{isSuggestPanelOpen&&setActiveOption(options?options[0]:"")},[options,isSuggestPanelOpen]),jsxRuntime.jsx(index$2.TextInput,{...props,ref:refSetter.refSetter(ref,inputRef),iconsAfter:iconArray,status,skeleton,isLoading,dimension,showTooltip:!isSuggestPanelOpen&&!skeleton,onKeyDown:(...p)=>{props.onKeyDown?.(...p),(e=>{keyboardKey.keyboardKey.getCode(e)===keyboardKey.keyboardKey.Enter&&isSuggestPanelOpen&&e.preventDefault()})(...p)},onFocus:(...p)=>{props.onFocus?.(...p),setIsFocused(!0)},onBlur:(...p)=>{props.onBlur?.(...p),triggerDelayedBlur({})},onChange:e=>{props.onChange?.(e),setSearchText(e.currentTarget.value)},children:options&&isSuggestPanelOpen&&!skeleton&&!emptyAtLoading&&!props.readOnly&&jsxRuntime.jsx(SuggestDropdownContainer,{targetElement:targetNode,alignSelf:alignDropdown||alignSelf,"data-dimension":dimension,dropContainerCssMixin,className:dropContainerClassName,style:dropContainerStyle,children:0!==options.length||isLoading?jsxRuntime.jsx(index$3.Menu,{model,dimension:menuDimension,maxHeight:dropMaxHeight||menuMaxHeight,active:activeOption,onActivateItem:setActiveOption,onSelectItem:option=>{if(onOptionSelect?.(option),!isControlledComponentValue&&inputRef.current){const cursorPosition=option.length;changeInputData.changeInputData(inputRef.current,{value:option,selectionStart:cursorPosition,selectionEnd:cursorPosition})}setIsSuggestPanelOpen(!1)},preventFocusSteal:!0,disableSelectionOnSpace:!0}):jsxRuntime.jsx(MessagePanel.MessagePanel,{dimension:menuDimension,children:locale?.emptyMessage||theme.locales[theme.currentLocale].suggestInput.emptyMessage})})})});SuggestInput.displayName="SuggestInput",exports.SuggestInput=SuggestInput;
//# sourceMappingURL=index.cjs.js.map
