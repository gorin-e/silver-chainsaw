import{jsxs,jsx}from"react/jsx-runtime";import{forwardRef,useRef,useState,useEffect}from"react";import styled,{css}from"styled-components";import{mediumGroupBorderRadius}from"../../themes/borderRadius.es.js";import{typography}from"../../Typography/typography.es.js";import"../../Typography/defaultTypographyMixin.es.js";import{getFileTypeIcon,formatFileType,formatFileSize}from"./utils.es.js";import{Spinner}from"../../Spinner/index.es.js";import{ReactComponent as SvgEyeOutline}from"../../../node_modules/@admiral-ds/icons/build/service/EyeOutline.svg.es.js";import{FILE_ITEM_PREVIEW_ICON_SIZE_XL,FILE_ITEM_FUNCTIONAL_ICON_SIZE_XL,FILE_ITEM_WRAPPER_PADDING_XL,FILE_ITEM_WRAPPER_PADDING_M,FILE_ITEM_WRAPPER_HEIGHT_XL,FILE_ITEM_WRAPPER_HEIGHT_M,ERROR_BLOCK_HEIGHT_XL,ERROR_BLOCK_HEIGHT_M}from"./style.es.js";import{Tooltip}from"../../Tooltip/index.es.js";import{checkOverflow}from"../../common/utils/checkOverflow.es.js";import{CloseIconPlacementButton}from"../../IconPlacement/index.es.js";import{keyboardKey}from"../../common/keyboardKey.es.js";const disabledStyles=css`
  pointer-events: none;
`,Container=styled.div`
  display: flex;
  flex-direction: column;
  overflow: hidden;
  cursor: ${({disabled})=>disabled?"not-allowed":"default"};
  ${p=>p.$filesLayoutCssMixin}
`,statusMixin=css`
  border-color: ${p=>"Error"===p.$status?`var(--admiral-color-Error_Error60Main, ${p.theme.color["Error/Error 60 Main"]})`:"Queue"===p.$status?`var(--admiral-color-Neutral_Neutral30, ${p.theme.color["Neutral/Neutral 30"]})`:`var(--admiral-color-Neutral_Neutral40, ${p.theme.color["Neutral/Neutral 40"]})`};
  color: ${p=>"Queue"===p.$status?`var(--admiral-color-Neutral_Neutral30, ${p.theme.color["Neutral/Neutral 30"]})`:`var(--admiral-color-Neutral_Neutral90, ${p.theme.color["Neutral/Neutral 90"]})`};
`,PreviewWrapper=styled.div`
  padding: 0;
  box-sizing: border-box;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  border-radius: var(--admiral-border-radius-Medium, ${p=>mediumGroupBorderRadius(p.theme.shape)});
  border-width: 1px;
  border-style: solid;
  ${typography["Body/Body 2 Long"]};
  ${statusMixin};
`,sizeMixin=css`
  align-items: center;
  justify-content: space-between;
`,hoveredFileTypeIconCss=css`
  &:hover {
    &:not(:disabled) {
      &::before {
        content: '';
        position: absolute;
        border-radius: var(--admiral-border-radius-Medium, ${p=>mediumGroupBorderRadius(p.theme.shape)});
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 100%;
        height: 100%;
        opacity: 0.6;
        background-color: var(
          --admiral-color-Special_DarkStaticNeutral00,
          ${p=>p.theme.color["Special/Dark Static Neutral 00"]}
        );
      }
      & svg {
        visibility: visible;
      }
      cursor: pointer;
    }
  }
`,getColor=css`
  ${({theme,$status})=>"Queue"===$status?`var(--admiral-color-Neutral_Neutral30, ${theme.color["Neutral/Neutral 30"]})`:`var(--admiral-color-Neutral_Neutral50, ${theme.color["Neutral/Neutral 50"]})`}
`,ImagePreview=styled.div`
  min-width: 40px;
  width: 40px;
  height: 40px;
  border-radius: var(--admiral-border-radius-Medium, ${p=>mediumGroupBorderRadius(p.theme.shape)});
  margin-right: 8px;
  overflow: hidden;

  > img {
    object-fit: cover;
    height: 100%;
    width: 100%;
  }
`,IconWrapper=styled.div`
  position: relative;
  margin-right: 8px;
  border-radius: var(--admiral-border-radius-Medium, ${p=>mediumGroupBorderRadius(p.theme.shape)});
  width: ${FILE_ITEM_PREVIEW_ICON_SIZE_XL};
  height: ${FILE_ITEM_PREVIEW_ICON_SIZE_XL};

  & *[fill^='#'] {
    fill: ${getColor};
  }

  ${p=>"Queue"!==p.$status&&p.$showHover?hoveredFileTypeIconCss:disabledStyles};

  &:focus-visible {
    outline-offset: 2px;
    outline: var(--admiral-color-Primary_Primary60Main, ${p=>p.theme.color["Primary/Primary 60 Main"]}) solid 2px;
  }
`,StyledEyeOutline=styled(SvgEyeOutline)`
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: ${FILE_ITEM_FUNCTIONAL_ICON_SIZE_XL};
  height: ${FILE_ITEM_FUNCTIONAL_ICON_SIZE_XL};
  visibility: hidden;

  & *[fill^='#'] {
    fill: var(--admiral-color-Special_StaticWhite, ${p=>p.theme.color["Special/Static White"]});
  }
`,Content=styled.div`
  ${p=>"m"===p.$dimension&&sizeMixin};
  display: flex;
  flex-direction: ${p=>"m"===p.$dimension?"row":"column"};
  min-width: 0;
  overflow: hidden;
`,FileInfoBlock=styled.div`
  display: ${p=>"m"===p.$dimension?"block":"flex"};
  box-sizing: border-box;
  align-items: center;
  overflow: hidden;
  height: ${p=>"xl"===p.$dimension?"40px":"20px"};
  padding: ${p=>"xl"===p.$dimension?FILE_ITEM_WRAPPER_PADDING_XL:FILE_ITEM_WRAPPER_PADDING_M};
  height: ${p=>"xl"===p.$dimension?FILE_ITEM_WRAPPER_HEIGHT_XL:FILE_ITEM_WRAPPER_HEIGHT_M};
`,FileName=styled.div`
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
`,FileInfo=styled.span`
  color: ${getColor};
  margin-left: ${p=>"xl"===p.$dimension?"0":"4px"};
  white-space: nowrap;
`,FunctionalBlock=styled.div`
  display: flex;
  flex: 0 0 auto;
  margin-left: 8px;
  align-items: center;
`,StyledSpinner=styled(Spinner)`
  margin-right: 8px;
`,ErrorBlock=styled.div`
  margin-top: 8px;
  color: var(--admiral-color-Error_Error60Main, ${p=>p.theme.color["Error/Error 60 Main"]});
  ${typography["Body/Body 2 Short"]};
  height: ${p=>"xl"===p.$dimension?ERROR_BLOCK_HEIGHT_XL:ERROR_BLOCK_HEIGHT_M};
`,CloseButton=styled(CloseIconPlacementButton)`
  margin-right: ${p=>"lSmall"===p.dimension?"8px":"16px"};
`,FileItem=forwardRef(({fileId,fileName,fileType,fileSize,status,errorMessage,previewImageURL,onCloseIconClick,onPreviewIconClick,dimension,filesLayoutCssMixin,formatFileSizeInfo=formatFileSize,formatFileTypeInfo=formatFileType,formatFileTypeIcon=getFileTypeIcon,...props},ref)=>{const PreviewIcon=formatFileTypeIcon(fileType),fileInfo=`${formatFileTypeInfo(fileType)}ãƒ»${formatFileSizeInfo(fileSize)}`,previewWrapperRef=useRef(null),titleRef=useRef(null),[tooltipVisible,setTooltipVisible]=useState(!1),[fileNameOverflow,setFileNameOverflow]=useState(!1);useEffect(()=>{const element=titleRef.current;element&&checkOverflow(element)!==fileNameOverflow&&setFileNameOverflow(checkOverflow(element))},[tooltipVisible,setFileNameOverflow]),useEffect(()=>{function show(){setTooltipVisible(!0)}function hide(){setTooltipVisible(!1)}const title=titleRef.current;if(title)return title.addEventListener("mouseenter",show),title.addEventListener("mouseleave",hide),()=>{title.removeEventListener("mouseenter",show),title.removeEventListener("mouseleave",hide)}},[setTooltipVisible]);const disabled="Queue"===status;return jsxs(Container,{ref,disabled,$dimension:dimension,$filesLayoutCssMixin:filesLayoutCssMixin,children:[jsxs(PreviewWrapper,{...props,ref:previewWrapperRef,$status:status,$dimension:dimension,children:[jsxs(FileInfoBlock,{$dimension:dimension,children:["xl"===dimension&&jsxs(IconWrapper,{$status:status,$showHover:!!onPreviewIconClick,onClick:()=>{onPreviewIconClick?.(fileId)},onKeyDown:e=>{const code=keyboardKey.getCode(e);code!==keyboardKey.Enter&&code!==keyboardKey[" "]||onPreviewIconClick?.(fileId)},tabIndex:onPreviewIconClick?0:-1,children:[previewImageURL?jsx(ImagePreview,{children:jsx("img",{src:previewImageURL,alt:""})}):jsx(PreviewIcon,{}),jsx(StyledEyeOutline,{})]}),jsxs(Content,{$dimension:dimension,children:[jsx(FileName,{ref:titleRef,children:fileName}),tooltipVisible&&fileNameOverflow&&jsx(Tooltip,{targetElement:previewWrapperRef.current,renderContent:()=>`${fileName}`}),jsx(FileInfo,{$dimension:dimension,$status:status,children:fileInfo})]})]}),jsxs(FunctionalBlock,{children:["Loading"===status&&jsx(StyledSpinner,{dimension:"m"===dimension?"ms":"m"}),onCloseIconClick&&jsx(CloseButton,{dimension:"xl"===dimension?"lSmall":"mSmall",disabled,onClick:()=>{onCloseIconClick?.(fileId)}})]})]}),errorMessage&&"Error"===status&&jsx(ErrorBlock,{$status:status,children:errorMessage})]})});export{ErrorBlock,FileItem};
//# sourceMappingURL=FileItem.es.js.map
