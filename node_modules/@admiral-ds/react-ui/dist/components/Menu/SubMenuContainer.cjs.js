"use strict";var jsxRuntime=require("react/jsx-runtime"),styled=require("styled-components"),DropdownProvider=require("../DropdownProvider.cjs.js"),PositionInPortal=require("../PositionInPortal.cjs.js"),useClickOutside=require("../common/hooks/useClickOutside.cjs.js"),parseShadowFromTheme=require("../common/utils/parseShadowFromTheme.cjs.js"),borderRadius=require("../themes/borderRadius.cjs.js"),throttle=require("../common/utils/throttle.cjs.js"),utils=require("./utils.cjs.js"),e=require("react");function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var styled__default=_interopDefault(styled);const AnchorWrapper=styled__default.default.div`
  display: inline-block;
  position: relative;
  cursor: pointer;
`,Portal=styled__default.default(PositionInPortal.PositionInPortal)`
  display: flex;
  flex-wrap: nowrap;
  ${({$flexDirection})=>$flexDirection?`flex-direction: ${$flexDirection};`:"flex-direction: column;"}
`,FakeTarget=styled__default.default.div`
  pointer-events: none;
  height: 100%;
  width: 100%;
  flex: 0 0 auto;
`,SubMenuWrapper=styled__default.default.div`
  position: relative;
  align-self: flex-start;
`,InnerContainer=styled__default.default.div`
  background-color: var(--admiral-color-Special_ElevatedBG, ${p=>p.theme.color["Special/Elevated BG"]});
  color: var(--admiral-color-Neutral_Neutral90, ${p=>p.theme.color["Neutral/Neutral 90"]});
  box-shadow: var(--admiral-box-shadow-Shadow08, ${p=>parseShadowFromTheme.parseShadow(p.theme.shadow["Shadow 08"])});
  border-radius: var(--admiral-border-radius-Medium, ${p=>borderRadius.mediumGroupBorderRadius(p.theme.shape)});
  overflow: hidden;
  box-sizing: border-box;
`,SubMenuContainer=({targetElement,children,onClickOutside,defaultRenderDirection="right",...props})=>{const{rootRef}=e.useContext(DropdownProvider.DropdownContext),wrapperRef=e.useRef(null),[recalculation,startRecalculation]=e.useState(null),[portalFlexDirection,setPortalFlexDirection]=e.useState("row");e.useLayoutEffect(()=>{const[listener,freeResources]=throttle.throttle(()=>{startRecalculation({})},100);return addEventListener("resize",listener),addEventListener("scroll",listener),()=>{removeEventListener("resize",listener),removeEventListener("scroll",listener),freeResources()}});const{addDropdown,removeDropdown,dropdowns}=DropdownProvider.useDropdown(wrapperRef);e.useLayoutEffect(()=>(addDropdown?.(wrapperRef),()=>{removeDropdown?.(wrapperRef)}),[]);return useClickOutside.useClickOutside([wrapperRef],e=>{targetElement&&!targetElement.contains(e.target)&&DropdownProvider.useDropdownsClickOutside(e,dropdowns)&&onClickOutside?.(e)}),e.useLayoutEffect(()=>{const wrapperElement=wrapperRef.current;if(targetElement&&wrapperElement){const{position,bottomOffset=0}=utils.getPosition(targetElement,wrapperElement,defaultRenderDirection);switch(position){case"right":setPortalFlexDirection("row"),wrapperElement.style.bottom=`${bottomOffset}px`;break;case"left":setPortalFlexDirection("row-reverse"),wrapperElement.style.bottom=`${bottomOffset}px`;break;case"rightBottom":default:setPortalFlexDirection("row"),wrapperElement.style.bottom="8px";break;case"leftBottom":setPortalFlexDirection("row-reverse"),wrapperElement.style.bottom="8px"}}},[targetElement,recalculation]),targetElement&&jsxRuntime.jsx(AnchorWrapper,{children:jsxRuntime.jsxs(Portal,{targetElement,rootRef,$flexDirection:portalFlexDirection,fullContainerWidth:!1,children:[jsxRuntime.jsx(FakeTarget,{}),jsxRuntime.jsx(SubMenuWrapper,{ref:wrapperRef,...props,children:jsxRuntime.jsx(InnerContainer,{children})})]})})};SubMenuContainer.displayName="SubMenu",exports.AnchorWrapper=AnchorWrapper,exports.FakeTarget=FakeTarget,exports.Portal=Portal,exports.SubMenuContainer=SubMenuContainer;
//# sourceMappingURL=SubMenuContainer.cjs.js.map
