"use strict";var jsxRuntime=require("react/jsx-runtime"),e=require("react"),keyboardKey=require("../common/keyboardKey.cjs.js"),useClickOutside=require("../common/hooks/useClickOutside.cjs.js"),getKeyboardFocusableElements=require("../common/utils/getKeyboardFocusableElements.cjs.js"),throttle=require("../common/utils/throttle.cjs.js"),DropdownProvider=require("../DropdownProvider.cjs.js"),styled=require("styled-components"),index=require("../themes/light/index.cjs.js");require("../themes/common/locales.cjs.js"),require("../Typography/typography.cjs.js"),require("../Typography/defaultTypographyMixin.cjs.js");var style=require("./style.cjs.js");function _interopNamespace(e){if(e&&e.__esModule)return e;var n=Object.create(null);return e&&Object.keys(e).forEach(function(k){if("default"!==k){var d=Object.getOwnPropertyDescriptor(e,k);Object.defineProperty(n,k,d.get?d:{enumerable:!0,get:function(){return e[k]}})}}),n.default=e,Object.freeze(n)}var e__namespace=_interopNamespace(e);const HintContainer=e__namespace.forwardRef(({dimension,isMobile,content,visibilityTrigger,scrollableParents,anchorElementRef,anchorId,hideHint,startRecalculation,locale,preventFocusSteal,...props},ref)=>{const theme=styled.useTheme()||index.LIGHT_THEME,closeBtnAriaLabel=locale?.closeButtonAriaLabel||theme.locales[theme.currentLocale].hint.closeButtonAriaLabel,hideOnScrollResize="hover"===visibilityTrigger,hintRef=e__namespace.useRef(null),previousFocusedElement=e__namespace.useRef(null),[firstFocusableChild,setFirstFocusableChild]=e__namespace.useState(),[lastFocusableChild,setLastFocusableChild]=e__namespace.useState(),{addDropdown,removeDropdown,dropdowns}=DropdownProvider.useDropdown(hintRef),handleClickOutside=e=>{DropdownProvider.useDropdownsClickOutside(e,dropdowns)&&hideHint()};"click"===visibilityTrigger&&useClickOutside.useClickOutside([hintRef,anchorElementRef],handleClickOutside),e__namespace.useLayoutEffect(()=>(addDropdown?.(hintRef),previousFocusedElement.current=document.activeElement,()=>{removeDropdown?.(hintRef)}),[]),e__namespace.useLayoutEffect(()=>{if(!preventFocusSteal&&hintRef.current&&"click"===visibilityTrigger){const focusableEls=getKeyboardFocusableElements.getKeyboardFocusableElements(hintRef.current);setFirstFocusableChild(focusableEls[0]),setLastFocusableChild(focusableEls[focusableEls.length-1]),focusableEls[0]?.focus()}},[visibilityTrigger,content,preventFocusSteal]),e__namespace.useImperativeHandle(ref,()=>hintRef.current),e__namespace.useLayoutEffect(()=>{const[listener,freeResources]=hideOnScrollResize?[hideHint,()=>{}]:throttle.throttle(()=>{startRecalculation({})},150);return addEventListener("resize",listener),addEventListener("scroll",listener),scrollableParents.forEach(el=>el.addEventListener("scroll",listener)),()=>{removeEventListener("resize",listener),removeEventListener("scroll",listener),scrollableParents.forEach(el=>el.removeEventListener("scroll",listener)),freeResources()}});return jsxRuntime.jsx(style.HintWrapper,{role:"tooltip",ref:hintRef,onKeyDown:event=>{event.stopPropagation();const code=keyboardKey.keyboardKey.getCode(event);code===keyboardKey.keyboardKey.Escape?(event.preventDefault(),previousFocusedElement.current.focus(),hideHint()):code===keyboardKey.keyboardKey.Tab&&"click"===visibilityTrigger&&(code===keyboardKey.keyboardKey.Shift?document.activeElement===firstFocusableChild&&(lastFocusableChild.focus(),event.preventDefault()):document.activeElement===lastFocusableChild&&(firstFocusableChild.focus(),event.preventDefault()))},children:jsxRuntime.jsxs(style.HintDialog,{...props,role:"dialog","aria-labelledby":anchorId,$dimension:dimension,$isMobile:isMobile,"data-trigger":visibilityTrigger,children:[jsxRuntime.jsx(style.HintContent,{children:content}),"click"===visibilityTrigger&&jsxRuntime.jsx(style.CloseButton,{dimension:"mSmall",highlightFocus:!1,"aria-label":closeBtnAriaLabel,onClick:event=>{event?.stopPropagation(),previousFocusedElement.current.focus(),hideHint()}})]})})});exports.HintContainer=HintContainer;
//# sourceMappingURL=HintContainer.cjs.js.map
