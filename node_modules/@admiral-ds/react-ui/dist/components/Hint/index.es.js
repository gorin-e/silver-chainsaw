import{jsxs,jsx}from"react/jsx-runtime";import*as e from"react";import{handleRef}from"../common/utils/handleRef.es.js";import{getScrollableParents}from"../common/utils/getScrollableParents.es.js";import{uid}from"../common/uid.es.js";import{keyboardKey}from"../common/keyboardKey.es.js";import{AnchorWrapper,Portal,FakeTarget}from"./style.es.js";import{getHintDirection}from"./utils.es.js";import{HintContainer}from"./HintContainer.es.js";import{DropdownContext}from"../DropdownProvider.es.js";const Hint=({visible,onVisibilityChange,renderContent,hintPosition,targetElement:userTargetElement,visibilityTrigger="hover",dimension="l",hintRef,children,anchorClassName,anchorId:anchorIdProp,anchorCssMixin,locale,preventFocusSteal,...props})=>{const{rootRef}=e.useContext(DropdownContext),anchorElementRef=e.useRef(null),hintElementRef=e.useRef(null),content=renderContent(),anchorId=anchorIdProp||uid(),targetElement=userTargetElement||anchorElementRef.current,[recalculation,startRecalculation]=e.useState(null),[portalFlexDirection,setPortalFlexDirection]=e.useState(""),[portalFullWidth,setPortalFullWidth]=e.useState(!1),[isMobile,setMobile]=e.useState(window.innerWidth<640),showHint=()=>onVisibilityChange?.(!0),hideHint=()=>onVisibilityChange?.(!1);e.useLayoutEffect(()=>{const listener=()=>{window.innerWidth<640?setMobile(!0):setMobile(!1)};return addEventListener("resize",listener),()=>{removeEventListener("resize",listener)}}),e.useLayoutEffect(()=>{const hint=hintElementRef.current;if(visible&&targetElement&&hint){const anchorElementRect=targetElement.getBoundingClientRect(),hintElementRect=hint.getBoundingClientRect();if(isMobile)window.innerHeight-anchorElementRect.bottom>hintElementRect.height?setPortalFlexDirection("column"):setPortalFlexDirection("column-reverse"),setPortalFullWidth(!0),hint.style.alignSelf="center",hint.style.margin="0";else{switch(getHintDirection(targetElement,hint,hintPosition)){case"topPageCenter":setPortalFlexDirection("column-reverse"),setPortalFullWidth(!0),hint.style.alignSelf="center",hint.style.margin="0";break;case"bottomPageCenter":setPortalFlexDirection("column"),setPortalFullWidth(!0),hint.style.alignSelf="center",hint.style.margin="0";break;case"right":setPortalFlexDirection("row"),setPortalFullWidth(!1),hint.style.alignSelf="center",hint.style.margin="0";break;case"left":setPortalFlexDirection("row-reverse"),setPortalFullWidth(!1),hint.style.alignSelf="center",hint.style.margin="0";break;case"top":setPortalFlexDirection("column-reverse"),setPortalFullWidth(!1),hint.style.alignSelf="center",hint.style.margin="0";break;case"bottom":setPortalFlexDirection("column"),setPortalFullWidth(!1),hint.style.alignSelf="center",hint.style.margin="0";break;case"rightTop":setPortalFlexDirection("row"),setPortalFullWidth(!1),hint.style.alignSelf="flex-end",hint.style.margin="0 0 -8px 0";break;case"rightBottom":setPortalFlexDirection("row"),setPortalFullWidth(!1),hint.style.alignSelf="flex-start",hint.style.margin="-8px 0 0 0";break;case"leftTop":setPortalFlexDirection("row-reverse"),setPortalFullWidth(!1),hint.style.alignSelf="flex-end",hint.style.margin="0 0 -8px 0";break;case"leftBottom":setPortalFlexDirection("row-reverse"),setPortalFullWidth(!1),hint.style.alignSelf="flex-start",hint.style.margin="-8px 0 0 0";break;case"topLeft":setPortalFlexDirection("column-reverse"),setPortalFullWidth(!1),hint.style.alignSelf="flex-end",hint.style.margin="0 -8px 0 0";break;case"topRight":setPortalFlexDirection("column-reverse"),setPortalFullWidth(!1),hint.style.alignSelf="flex-start",hint.style.margin="0 0 0 -8px";break;case"bottomLeft":setPortalFlexDirection("column"),setPortalFullWidth(!1),hint.style.alignSelf="flex-end",hint.style.margin="0 -8px 0 0";break;default:setPortalFlexDirection("column"),setPortalFullWidth(!1),hint.style.alignSelf="flex-start",hint.style.margin="0 0 0 -8px"}}}},[userTargetElement,hintPosition,visible,recalculation,dimension,content,isMobile]);const scrollableParents=e.useMemo(()=>getScrollableParents(anchorElementRef.current)??[],[anchorElementRef.current]);return e.useEffect(()=>{visible&&hintElementRef.current&&(hintElementRef.current.style.opacity="1")},[visible]),jsxs(AnchorWrapper,{onMouseEnter:"click"===visibilityTrigger?void 0:showHint,onMouseLeave:"click"===visibilityTrigger?void 0:hideHint,onFocus:"click"===visibilityTrigger?void 0:showHint,onBlur:"click"===visibilityTrigger?void 0:hideHint,onClick:"click"===visibilityTrigger?showHint:void 0,onKeyDown:"click"===visibilityTrigger?event=>{const code=keyboardKey.getCode(event);code!==keyboardKey.Enter&&code!==keyboardKey[" "]||(event.preventDefault(),showHint())}:void 0,ref:anchorElementRef,className:anchorClassName,id:anchorId,$anchorCssMixin:anchorCssMixin,children:[children,visible&&jsxs(Portal,{targetElement,rootRef,$flexDirection:portalFlexDirection,fullContainerWidth:portalFullWidth,children:[jsx(FakeTarget,{}),jsx(HintContainer,{ref:node=>handleRef(node,hintRef,hintElementRef),dimension,isMobile,content,visibilityTrigger,scrollableParents,startRecalculation,anchorElementRef,anchorId,hideHint,locale,preventFocusSteal,...props})]})]})};Hint.displayName="Hint";export{Hint};
//# sourceMappingURL=index.es.js.map
