"use strict";var e=require("react"),jsxRuntime=require("react/jsx-runtime"),styled=require("styled-components"),uid=require("../common/uid.cjs.js"),keyboardKey=require("../common/keyboardKey.cjs.js"),MenuItem=require("../Menu/MenuItem.cjs.js"),index$1=require("../DropMenu/index.cjs.js"),splitDataAttributes=require("../common/utils/splitDataAttributes.cjs.js"),index=require("../AvatarBase/index.cjs.js");function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var styled__default=_interopDefault(styled);const AvatarsBaseWrapper=styled__default.default.div`
  position: relative;
  display: flex;
  flex: 1 1 auto;
  width: 100%;
  white-space: nowrap;
  & > * {
    margin-left: -${p=>p.$withActivityRing?10:2}px;
  }
  & > *:first-child {
    margin-left: 0;
  }
`,AvatarBaseMenuItem=styled__default.default(MenuItem.MenuItem)`
  flex-flow: nowrap;
  justify-content: flex-start;
  & > button:first-child {
    margin-right: 8px;
  }
`,MenuAvatarBase=styled__default.default(index.AvatarBase)`
  cursor: pointer;
`,AvatarBaseGroup=({items,dimension="xl",appearance="neutral2",onAvatarSelect,menuWidth,menuMaxHeight,dropContainerCssMixin,dropContainerClassName,dropContainerStyle,withActivityRing=!1,...props})=>{const dropMenuProps=splitDataAttributes.passDropdownDataAttributes(props),wrapperRef=e.useRef(null),[visibleItems,setVisibleItems]=e.useState(items.length),[hiddenItems,setHiddenItems]=e.useState(0),[selected,setSelected]=e.useState(void 0),WIDTH={xs:24,s:32,m:40,l:48,xl:56};e.useLayoutEffect(()=>{if(wrapperRef.current){const resizeObserver=new ResizeObserver(entries=>{entries.forEach(entry=>{const visibleItems=~~((entry.contentRect.width||0)/WIDTH[dimension]);setVisibleItems(visibleItems>=items.length?items.length:Math.max(visibleItems-1,0)),setHiddenItems(visibleItems>=items.length?0:items.length-visibleItems+1)})});return resizeObserver.observe(wrapperRef.current),()=>{resizeObserver.disconnect()}}},[dimension]);const visible=items.slice(0,visibleItems),hidden=items.slice(visibleItems,visibleItems+hiddenItems),modelHidden=e.useMemo(()=>hidden.map(({id:idProp,...item})=>{const id=idProp||uid.uid();return{id,render:options=>jsxRuntime.jsxs(AvatarBaseMenuItem,{role:"option",id,dimension:"m",...options,children:[jsxRuntime.jsx(index.AvatarBase,{...item,userName:item.userName,dimension:"xs",appearance:item.appearance||appearance,showTooltip:!1,status:void 0,withActivityRing,showActivityRing:item.showActivityRing}),item.userName]},id)}}),[hidden]),handleSelectAvatar=id=>{onAvatarSelect?.(id),setSelected(id)},containsActiveAvatar=e.useMemo(()=>-1!=modelHidden.findIndex(item=>item.id===selected),[modelHidden,selected]);return jsxRuntime.jsxs(AvatarsBaseWrapper,{ref:wrapperRef,...props,$withActivityRing:withActivityRing,children:[1===items.length&&jsxRuntime.jsx(index.AvatarBase,{...items[0],dimension,withActivityRing}),items.length>1&&visible.map((item,index$1)=>{const id=item.id||uid.uid(),last=index$1===items.length-1;return e.createElement(index.AvatarBase,{...item,userName:item.userName,key:id,id,onClick:e=>{item.onClick&&item.onClick(e),handleSelectAvatar(e.currentTarget.id)},onKeyDown:e=>{const code=keyboardKey.keyboardKey.getCode(e);code!==keyboardKey.keyboardKey.Enter&&code!==keyboardKey.keyboardKey[" "]||(item.onKeyDown&&item.onKeyDown(e),handleSelectAvatar(e.currentTarget.id))},dimension,appearance:item.appearance||appearance,group:!last,status:void 0,withActivityRing})}),hiddenItems>0?jsxRuntime.jsx(index$1.DropMenu,{dimension:"m",menuWidth,menuMaxHeight,items:modelHidden,selected:containsActiveAvatar?selected:void 0,onSelectItem:handleSelectAvatar,disabled:!1,alignSelf:"flex-start",dropContainerCssMixin,dropContainerClassName,dropContainerStyle,...dropMenuProps,renderContentProp:({buttonRef,handleKeyDown,handleClick})=>jsxRuntime.jsx(MenuAvatarBase,{ref:buttonRef,userName:"+"+modelHidden.length,isMenuAvatar:!0,appearance,dimension,showTooltip:!1,onClick:handleClick,onKeyDown:handleKeyDown,className:"avatar-menu-with-dropdown",withActivityRing})}):null]})};AvatarBaseGroup.displayName="AvatarBaseGroup",exports.AvatarBaseGroup=AvatarBaseGroup;
//# sourceMappingURL=index.cjs.js.map
