import{jsx,jsxs}from"react/jsx-runtime";import{forwardRef,useRef,useEffect,useLayoutEffect}from"react";import{createPortal}from"react-dom";import styled,{keyframes,css,useTheme}from"styled-components";import{getKeyboardFocusableElements}from"../common/utils/getKeyboardFocusableElements.es.js";import{parseShadow}from"../common/utils/parseShadowFromTheme.es.js";import{refSetter}from"../common/utils/refSetter.es.js";import{LIGHT_THEME}from"../themes/light/index.es.js";import"../themes/common/locales.es.js";import"../Typography/typography.es.js";import"../Typography/defaultTypographyMixin.es.js";import{manager}from"../Modal/manager.es.js";import{CloseIconPlacementButton}from"../IconPlacement/index.es.js";import{DrawerContext}from"./components.es.js";export{DrawerButtonPanel,DrawerContent,DrawerTitle}from"./components.es.js";const fadeInRight=keyframes`
  from {
    transform: translateX(100%);
  }
  to {
    transform: translateX(0);
  }
`,fadeInLeft=keyframes`
  from {
    transform: translateX(-100%);
  }
  to {
    transform: translateX(0);
  }
`,fadeInMixin=css`
  animation-name: ${({$position})=>"right"===$position?fadeInRight:fadeInLeft};
  animation-duration: ${"0.3s"};
  animation-timing-function: ${"cubic-bezier(0, 0, 0.2, 1)"};
`,Overlay=styled.div`
  display: flex;
  align-items: center;
  justify-content: center;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  z-index: var(--admiral-z-index-drawer, ${({theme})=>theme.zIndex.drawer});
  ${p=>p.$overlayCssMixin}
  outline: none;
  pointer-events: none;
  background-color: transparent;
  transition: background-color ${"\n  0.3s cubic-bezier(0, 0, 0.2, 1) 0ms\n"};

  &[data-visible='true'] {
    ${({theme,$backdrop})=>$backdrop&&`background-color: var(--admiral-color-Opacity_Modal, ${theme.color["Opacity/Modal"]});`}
    ${({$backdrop})=>$backdrop&&"pointer-events: auto;"}

    & > div {
      opacity: 1;
      transform: translateX(0);
      transition: opacity 0ms linear 0ms;
      ${fadeInMixin}
    }
  }
`,DrawerComponent=styled.div`
  position: absolute;
  box-sizing: border-box;
  top: 0;
  bottom: 0;
  ${({$position})=>"right"===$position?"right: 0;":"left: 0;"}
  display: flex;
  flex: 1 0 auto;
  flex-direction: column;
  overflow: hidden;
  padding: 20px 0 24px;
  ${({$mobile})=>$mobile&&"min-width: calc(100% - 16px);"}
  max-width: calc(100% - 16px);
  background-color: var(--admiral-color-Neutral_Neutral00, ${p=>p.theme.color["Neutral/Neutral 00"]});
  color: var(--admiral-color-Neutral_Neutral90, ${p=>p.theme.color["Neutral/Neutral 90"]});
  box-shadow: var(--admiral-box-shadow-Shadow16, ${p=>parseShadow(p.theme.shadow["Shadow 16"])});
  outline: none;
  transform: ${({$position})=>"right"===$position?"translateX(100%)":"translateX(-100%)"};
  transition:
    transform ${"\n  0.3s cubic-bezier(0, 0, 0.2, 1) 0ms\n"},
    opacity 0ms linear 0.3s;
  pointer-events: auto;
  opacity: 0;
`,CloseButton=styled(CloseIconPlacementButton)`
  position: absolute;
  top: 20px;
  right: ${({$mobile})=>$mobile?16:24}px;
`,nothing=()=>{},Drawer=forwardRef(({isOpen=!1,position:userPosition="right",backdrop=!0,overlayCssMixin=css``,overlayClassName,overlayStyle,container,mobile=!1,onClose,closeOnEscapeKeyDown=!1,closeOnBackdropClick=!1,displayCloseIcon=!0,children,locale,closeButtonPropsConfig=nothing,...props},ref)=>{const position=mobile?"right":userPosition,theme=useTheme()||LIGHT_THEME,closeBtnAriaLabel=locale?.closeButtonAriaLabel||theme.locales[theme.currentLocale].modal.closeButtonAriaLabel,drawer=useRef({}),drawerRef=useRef(null),overlayRef=useRef(null),previousFocusedElement=useRef(null);useEffect(()=>{overlayRef.current&&(overlayRef.current.dataset.visible=isOpen?"true":"false")},[isOpen]);const getDrawer=()=>(drawer.current.modalEl=drawerRef.current,drawer.current.containerEl=container||document.body,drawer.current);useLayoutEffect(()=>{if(backdrop&&isOpen)return manager.add(getDrawer(),container||document.body),drawerRef.current&&manager.mount(getDrawer()),()=>{manager.remove(getDrawer())}},[backdrop,isOpen,container]),useLayoutEffect(()=>{if(isOpen)return previousFocusedElement.current=document.activeElement,drawerRef.current?.focus(),()=>{previousFocusedElement.current?.focus()}},[isOpen]);const closeButtonProps={dimension:"lSmall","aria-label":closeBtnAriaLabel,$mobile:mobile,onClick:event=>{event.stopPropagation(),onClose?.()}};return createPortal(jsx(Overlay,{ref:overlayRef,tabIndex:-1,onMouseDown:event=>{closeOnBackdropClick&&event.target===overlayRef.current&&onClose?.()},onKeyDown:event=>{if("Escape"===event.key&&closeOnEscapeKeyDown)event.preventDefault(),event.stopPropagation(),onClose?.();else if("Tab"===event.key){const focusableEls=getKeyboardFocusableElements(drawerRef.current);event.shiftKey?document.activeElement!==focusableEls[0]&&document.activeElement!==drawerRef.current||(focusableEls[focusableEls.length-1].focus(),event.preventDefault()):document.activeElement===focusableEls[focusableEls.length-1]&&(focusableEls[0].focus(),event.preventDefault())}},$overlayCssMixin:overlayCssMixin,className:overlayClassName,style:overlayStyle,$backdrop:backdrop,"data-visible":!1,$position:position,children:jsxs(DrawerComponent,{ref:refSetter(ref,drawerRef),tabIndex:-1,role:"dialog","aria-modal":!0,$position:position,$mobile:mobile,...props,children:[jsx(DrawerContext.Provider,{value:{mobile,displayCloseIcon},children}),displayCloseIcon&&jsx(CloseButton,{...closeButtonProps,...closeButtonPropsConfig(closeButtonProps)})]})}),container||document.body)});Drawer.displayName="Drawer";export{Drawer};
//# sourceMappingURL=index.es.js.map
