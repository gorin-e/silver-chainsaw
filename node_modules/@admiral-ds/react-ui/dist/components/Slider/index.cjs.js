"use strict";var jsxRuntime=require("react/jsx-runtime"),e=require("react"),keyboardKey=require("../common/keyboardKey.cjs.js"),throttle=require("../common/utils/throttle.cjs.js"),utils=require("./utils.cjs.js"),style=require("./style.cjs.js"),TickMarks=require("./TickMarks.cjs.js"),ThumbTooltip=require("./ThumbTooltip.cjs.js");const Slider=({minValue=0,maxValue=20,decimal,thousand,precision=2,value=0,onChange,renderTickMark,tickMarks:points,disabled=!1,step:userStep=1,dimension="xl",skeleton=!1,showTooltip=!1,...props})=>{const tickMarks=Array.isArray(points)?points:void 0,step="number"==typeof userStep&&userStep>0||"any"===userStep?userStep:1,[isDraging,setDrag]=e.useState(!1),[animation,setAnimation]=e.useState(!0),[rangeWidth,setRangeWidth]=e.useState(0),trackRef=e.useRef(null),[filledTrack,setFilledTrack]=e.useState(null),[thumb,setThumb]=e.useState(null);e.useLayoutEffect(()=>{let newValue=value;if(step&&"any"!==step&&(newValue=Math.round(newValue/step)*step,step.toString().includes("."))){const decimal=step.toString().match(/\.(\d+)/)?.[1].length;newValue=+newValue.toFixed(decimal)}newValue<minValue&&(newValue=minValue),newValue>maxValue&&(newValue=maxValue),function(value){let calcPercents=(rangeWidth?rangeWidth/(maxValue-minValue):0)*(value>=0?value-minValue:-minValue+value)/rangeWidth*100;calcPercents=calcPercents>100?100:calcPercents,calcPercents=calcPercents<0?0:calcPercents;const sliderCoords=String(value)?calcPercents:0;thumb&&filledTrack&&(thumb.style.left=`${sliderCoords}%`,filledTrack.style.width=`${sliderCoords}%`)}(newValue)},[value,minValue,maxValue,step,rangeWidth,thumb,filledTrack]),e.useLayoutEffect(()=>{if(trackRef.current){const resizeObserver=new ResizeObserver(entries=>{entries.forEach(entry=>setRangeWidth(entry.contentRect.width||0))});return resizeObserver.observe(trackRef.current),()=>{resizeObserver.disconnect()}}},[setRangeWidth]);const[handleMouseMove,freeResources]=throttle.throttle(e=>{const newValue=utils.calcValue(e,trackRef,minValue,maxValue,step,void 0);newValue!==value&&(onChange(e,newValue),setAnimation(!1))},50);e.useEffect(()=>(isDraging&&!disabled&&(document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp),document.addEventListener("touchmove",handleMouseMove),document.addEventListener("touchend",handleMouseUp),document.addEventListener("touchcancel",handleMouseUp)),()=>{freeResources(),document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp),document.removeEventListener("touchmove",handleMouseMove),document.removeEventListener("touchend",handleMouseUp),document.removeEventListener("touchcancel",handleMouseUp)}));const onSliderClick=e=>{e.stopPropagation(),"mousedown"===e.type?props.onMouseDown?.(e):props.onTouchStart?.(e),setDrag(!0),setAnimation(!0)},onTrackClick=e=>{setAnimation(!0),tickMarks||setDrag(!0);const newValue=utils.calcValue(e,trackRef,minValue,maxValue,step,tickMarks);newValue!==value&&onChange(e,newValue)},handleMouseUp=e=>{setDrag(!1),setAnimation(!0);const newValue=utils.calcValue(e,trackRef,minValue,maxValue,step,tickMarks);newValue!==value&&onChange(e,newValue)};return jsxRuntime.jsx(style.Wrapper,{"data-disabled":disabled,$disabled:disabled,$skeleton:skeleton,...props,children:jsxRuntime.jsx(style.TrackWrapper,{$dimension:dimension,$skeleton:skeleton,onTouchStart:onTrackClick,onMouseDown:onTrackClick,children:jsxRuntime.jsxs(style.Track,{children:[jsxRuntime.jsx(style.FilledTrack,{ref:node=>setFilledTrack(node),$animation:animation}),jsxRuntime.jsxs(style.DefaultTrack,{ref:trackRef,children:[jsxRuntime.jsx(TickMarks.TickMarks,{tickMarks:tickMarks?[minValue,...tickMarks,maxValue]:[minValue,maxValue],minValue,maxValue,decimal,precision,thousand,onPointClick:(e,newValue)=>{e.stopPropagation(),props.onMouseDown?.(e),setAnimation(!0),newValue!==value&&onChange(e,newValue)},renderTickMark}),jsxRuntime.jsx(style.Thumb,{ref:node=>setThumb(node),$animation:animation,$dimension:dimension,role:"slider",tabIndex:disabled?-1:0,"aria-valuenow":value,"aria-valuemin":minValue,"aria-valuemax":maxValue,onKeyDown:e=>{switch(keyboardKey.keyboardKey.getCode(e)){case keyboardKey.keyboardKey.ArrowLeft:setAnimation(!0),"any"!==step&&value-step>=minValue&&value-step!==value&&onChange(e,value-step),e.preventDefault();break;case keyboardKey.keyboardKey.ArrowRight:setAnimation(!0),"any"!==step&&value+step<=maxValue&&value+step!==value&&onChange(e,value+step),e.preventDefault()}},children:jsxRuntime.jsx(style.ThumbCircle,{$dimension:dimension,onTouchStart:onSliderClick,onMouseDown:onSliderClick})}),showTooltip&&jsxRuntime.jsx(ThumbTooltip.ThumbTooltip,{targetElement:thumb,value,isDraging})]})]})})})};Slider.displayName="Slider",exports.Slider=Slider;
//# sourceMappingURL=index.cjs.js.map
