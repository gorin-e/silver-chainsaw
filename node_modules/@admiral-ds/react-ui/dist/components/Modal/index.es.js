import{jsx,jsxs}from"react/jsx-runtime";import{createPortal}from"react-dom";import styled,{css,useTheme}from"styled-components";import{createContext,forwardRef,useRef,useEffect,useContext}from"react";import{getKeyboardFocusableElements}from"../common/utils/getKeyboardFocusableElements.es.js";import{refSetter}from"../common/utils/refSetter.es.js";import{parseShadow}from"../common/utils/parseShadowFromTheme.es.js";import{typography}from"../Typography/typography.es.js";import"../Typography/defaultTypographyMixin.es.js";import{LIGHT_THEME}from"../themes/light/index.es.js";import"../themes/common/locales.es.js";import{largeGroupBorderRadius}from"../themes/borderRadius.es.js";import{manager}from"./manager.es.js";import{CloseIconPlacementButton}from"../IconPlacement/index.es.js";import{ReactComponent as SvgInfoOutline}from"../../node_modules/@admiral-ds/icons/build/service/InfoOutline.svg.es.js";import{ReactComponent as SvgCheckOutline}from"../../node_modules/@admiral-ds/icons/build/service/CheckOutline.svg.es.js";import{ReactComponent as SvgCloseCircleOutline}from"../../node_modules/@admiral-ds/icons/build/service/CloseCircleOutline.svg.es.js";import{ReactComponent as SvgErrorOutline}from"../../node_modules/@admiral-ds/icons/build/service/ErrorOutline.svg.es.js";import{ScrollContainer}from"../Scrollbar/index.es.js";const Overlay=styled.div`
  display: flex;
  align-items: center;
  justify-content: center;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  background-color: var(--admiral-color-Opacity_Modal, ${p=>p.theme.color["Opacity/Modal"]});
  transition: opacity 0.3s ease 0s;
  z-index: var(--admiral-z-index-modal, ${({theme})=>theme.zIndex.modal});
  ${p=>p.$overlayStyledCss}
  outline: none;
`,width=css`
  width: ${({$dimension,$mobile})=>{if($mobile)return"calc(100% - 32px)";switch($dimension){case"s":return"384px";case"m":return"488px";case"xl":return"800px";default:return"592px"}}};
`,Title=styled.h5`
  ${({$mobile})=>$mobile?typography["Header/H6"]:typography["Header/H5"]};
  color: var(--admiral-color-Neutral_Neutral90, ${p=>p.theme.color["Neutral/Neutral 90"]});
  margin: 0;
  padding: ${({$mobile,$displayCloseIcon})=>$mobile?$displayCloseIcon?"0 46px 8px 16px":"0 16px 8px":$displayCloseIcon?"0 56px 8px 24px":"0 24px 8px"};
`,ButtonPanel=styled.div`
  display: flex;
  flex-direction: ${({$mobile})=>$mobile?"column-reverse":"row-reverse"};
  padding: ${({$mobile})=>$mobile?"16px 16px 0":"16px 24px 0"};

  & > button {
    margin: ${({$mobile})=>$mobile?"0 0 16px 0":"0 16px 0 0"};
    ${({$mobile})=>$mobile&&"width: 100%;"}
  }

  & > button:first-child {
    margin: 0;
  }
`;function getModalIcon(status){switch(status){case"success":return jsx(SvgCheckOutline,{});case"warning":return jsx(SvgErrorOutline,{});case"danger":return jsx(SvgCloseCircleOutline,{});default:return jsx(SvgInfoOutline,{})}}const modalIconColor=css`
  fill: ${({$status,theme})=>{switch($status){case"success":return`var(--admiral-color-Success_Success50Main, ${theme.color["Success/Success 50 Main"]})`;case"warning":return`var(--admiral-color-Warning_Warning50Main, ${theme.color["Warning/Warning 50 Main"]})`;case"danger":return`var(--admiral-color-Error_Error60Main, ${theme.color["Error/Error 60 Main"]})`;default:return`var(--admiral-color-Primary_Primary60Main, ${theme.color["Primary/Primary 60 Main"]})`}}};
`,ModalStatusIconWrapper=styled.div`
  margin-left: ${({$mobile})=>$mobile?16:24}px;
  margin-bottom: ${({$mobile})=>$mobile?6:8}px;
  width: 40px;
  height: 40px;

  & *[fill^='#'] {
    ${modalIconColor}
  }
`,ModalComponent=styled.div`
  position: absolute;
  box-sizing: border-box;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  padding: 20px 0 24px;
  ${width};
  max-height: ${({$mobile})=>$mobile?"84vh":"90vh"};
  background-color: var(--admiral-color-Special_ElevatedBG, ${p=>p.theme.color["Special/Elevated BG"]});
  box-shadow: var(--admiral-box-shadow-Shadow16, ${p=>parseShadow(p.theme.shadow["Shadow 16"])});
  border-radius: var(--admiral-border-radius-Large, ${p=>largeGroupBorderRadius(p.theme.shape)});
  ${({$mobile})=>$mobile?typography["Body/Body 2 Long"]:typography["Body/Body 1 Long"]}
  color: var(--admiral-color-Neutral_Neutral90, ${p=>p.theme.color["Neutral/Neutral 90"]});
  outline: none;
`,CloseButton=styled(CloseIconPlacementButton)`
  position: absolute;
  top: 16px;
  right: ${({$mobile})=>$mobile?12:20}px;
`,emptyOverlayStyledCss=css``,ModalContext=createContext({mobile:!1,displayCloseIcon:!0}),nothing=()=>{},Modal=forwardRef(({overlayStyledCss=emptyOverlayStyledCss,overlayClassName,overlayStyle,dimension="l",container,mobile=!1,onClose,closeOnEscapeKeyDown,closeOnOutsideClick,displayCloseIcon=!0,children,locale,closeButtonPropsConfig=nothing,...props},ref)=>{const theme=useTheme()||LIGHT_THEME,closeBtnAriaLabel=locale?.closeButtonAriaLabel||theme.locales[theme.currentLocale].modal.closeButtonAriaLabel,modalRef=useRef(null),overlayRef=useRef(null),previousFocusedElement=useRef(null);useEffect(()=>{if(modalRef.current){previousFocusedElement.current=document.activeElement,modalRef.current.focus();const modal={containerEl:container||document.body,modalEl:modalRef.current};return manager.add(modal,container||document.body),manager.mount(modal),()=>{previousFocusedElement.current.focus(),manager.remove(modal)}}},[container]);const closeButtonProps={dimension:"lSmall","aria-label":closeBtnAriaLabel,$mobile:mobile,onClick:event=>{event.stopPropagation(),onClose?.()}};return createPortal(jsx(Overlay,{ref:overlayRef,tabIndex:-1,onMouseDown:event=>{closeOnOutsideClick&&event.target===overlayRef.current&&onClose?.()},onKeyDown:event=>{if("Escape"===event.key&&closeOnEscapeKeyDown)event.preventDefault(),event.stopPropagation(),onClose?.();else if("Tab"===event.key){const focusableEls=getKeyboardFocusableElements(modalRef.current);event.shiftKey?document.activeElement!==focusableEls[0]&&document.activeElement!==modalRef.current||(focusableEls[focusableEls.length-1].focus(),event.preventDefault()):document.activeElement===focusableEls[focusableEls.length-1]&&(focusableEls[0].focus(),event.preventDefault())}},$overlayStyledCss:overlayStyledCss,className:overlayClassName,style:overlayStyle,children:jsxs(ModalComponent,{ref:refSetter(ref,modalRef),tabIndex:-1,role:"dialog","aria-modal":!0,$dimension:dimension,$mobile:mobile,...props,children:[jsx(ModalContext.Provider,{value:{mobile,displayCloseIcon},children}),displayCloseIcon&&jsx(CloseButton,{...closeButtonProps,...closeButtonPropsConfig(closeButtonProps)})]})}),container||document.body)});Modal.displayName="Modal";const ModalTitle=({children,...props})=>{const{mobile,displayCloseIcon}=useContext(ModalContext);return jsx(Title,{$mobile:mobile,$displayCloseIcon:displayCloseIcon,as:mobile?"h6":"h5",...props,children})},ModalContent=({children,contentBlockProps={},...props})=>{const mobile=useContext(ModalContext).mobile;return contentBlockProps.style={...contentBlockProps.style,paddingBlock:"8px",paddingInline:mobile?"16px":"24px"},jsx(ScrollContainer,{tabIndex:-1,contentBlockProps,...props,children})},ModalButtonPanel=({children,...props})=>{const mobile=useContext(ModalContext).mobile;return jsx(ButtonPanel,{$mobile:mobile,...props,children})},ModalStatusIcon=({status})=>{const mobile=useContext(ModalContext).mobile;return jsx(ModalStatusIconWrapper,{$status:status,$mobile:mobile,children:getModalIcon(status)})};export{Modal,ModalButtonPanel,ModalContent,ModalStatusIcon,ModalTitle,emptyOverlayStyledCss};
//# sourceMappingURL=index.es.js.map
