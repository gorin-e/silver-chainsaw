import{jsxs,jsx}from"react/jsx-runtime";import{refSetter}from"../common/utils/refSetter.es.js";import{getScrollbarSize}from"../common/dom/scrollbarUtil.es.js";import{Portal,FakeTarget,TooltipWrapper,TooltipContainer}from"./style.es.js";import{getTooltipDirection}from"./utils.es.js";import{DropdownContext}from"../DropdownProvider.es.js";import{forwardRef,useRef,useContext,useMemo,useState,useEffect,useLayoutEffect}from"react";const TOOLTIP_DELAY=1500,Tooltip=forwardRef(({dimension="m",renderContent,targetElement,tooltipPosition,...props},ref)=>{const tooltipElementRef=useRef(null),tooltipHeight=useRef(0),{rootRef}=useContext(DropdownContext),emptyContent=useMemo(()=>!renderContent()&&0!==renderContent(),[renderContent]),[portalFlexDirection,setPortalFlexDirection]=useState(),[portalFullWidth,setPortalFullWidth]=useState(!1),[recalculation,startRecalculation]=useState({});return useEffect(()=>{(scrollbarSize=>{const target=targetElement;if(target&&tooltipElementRef.current){const direction=getTooltipDirection(target,tooltipElementRef.current,scrollbarSize,tooltipPosition),tooltip=tooltipElementRef.current;switch(direction){case"leftBottom":case"leftTop":case"left":setPortalFlexDirection("row-reverse"),setPortalFullWidth(!1),tooltip.style.margin="0 8px 0 0",tooltip.style.alignSelf="leftBottom"===direction?"flex-start":"leftTop"===direction?"flex-end":"center";break;case"rightBottom":case"rightTop":case"right":setPortalFlexDirection("row"),setPortalFullWidth(!1),tooltip.style.margin="0 0 0 8px",tooltip.style.alignSelf="rightBottom"===direction?"flex-start":"rightTop"===direction?"flex-end":"center";break;case"topPageCenter":case"topLeft":case"topRight":case"top":setPortalFlexDirection("column-reverse"),setPortalFullWidth("topPageCenter"===direction),tooltip.style.margin="0 0 8px 0",tooltip.style.alignSelf="topLeft"===direction?"flex-end":"topRight"===direction?"flex-start":"center";break;default:setPortalFlexDirection("column"),setPortalFullWidth("bottomPageCenter"===direction),tooltip.style.margin="8px 0 0 0",tooltip.style.alignSelf="bottomLeft"===direction?"flex-end":"bottomRight"===direction?"flex-start":"center"}}})(getScrollbarSize())},[renderContent(),targetElement,tooltipPosition,recalculation]),useLayoutEffect(()=>{if(tooltipElementRef.current&&!emptyContent){const resizeObserver=new ResizeObserver(entries=>{entries.forEach(entry=>{0===tooltipHeight.current?tooltipHeight.current=entry.contentRect.height:startRecalculation({})})});return resizeObserver.observe(tooltipElementRef.current),()=>{resizeObserver.disconnect()}}},[emptyContent]),useEffect(()=>{tooltipElementRef.current&&!emptyContent&&(tooltipElementRef.current.style.opacity="1")},[emptyContent]),emptyContent?null:jsxs(Portal,{targetElement,rootRef,$flexDirection:portalFlexDirection,fullContainerWidth:portalFullWidth,children:[jsx(FakeTarget,{}),jsx(TooltipWrapper,{ref:refSetter(ref,tooltipElementRef),children:jsx(TooltipContainer,{role:"tooltip",$dimension:dimension,...props,children:renderContent()})})]})});Tooltip.displayName="Tooltip";export{TOOLTIP_DELAY,Tooltip};
//# sourceMappingURL=index.es.js.map
